<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë‰´í‚¤ì¦ˆ - í•™ë¶€ëª¨ ê²Œì‹œíŒ</title>
    <style>
        /* [ìŠ¤íƒ€ì¼] */
        * { box-sizing: border-box; }
        body { font-family: 'Pretendard', sans-serif; background: #f0f2f5; margin: 0; padding: 20px; }
        a { text-decoration: none; }

        .container { max-width: 900px; margin: 0 auto; background: white; padding: 40px; border-radius: 15px; box-shadow: 0 5px 20px rgba(0,0,0,0.05); }
        
        /* [ìˆ˜ì •ë¨] í—¤ë” ì˜ì—­ ìŠ¤íƒ€ì¼ */
        .board-header { 
            display: flex; justify-content: space-between; align-items: center; 
            border-bottom: 2px solid #1a3c6e; padding-bottom: 20px; margin-bottom: 20px; 
            flex-wrap: wrap; gap: 15px; /* ëª¨ë°”ì¼ì—ì„œ ì¤„ë°”ê¿ˆ ëŒ€ì‘ */
        }
        .board-title { color: #1a3c6e; font-size: 1.8rem; font-weight: bold; }
        
        /* ë²„íŠ¼ ê·¸ë£¹ (í™ˆìœ¼ë¡œ + ë¡œê·¸ì•„ì›ƒ) */
        .header-btns { display: flex; gap: 10px; }

        .btn-common { padding: 8px 15px; border-radius: 5px; font-weight: bold; font-size: 0.9rem; cursor: pointer; border: none; transition: 0.3s; display: flex; align-items: center; justify-content: center; }
        
        /* í™ˆ ë²„íŠ¼ ìƒ‰ìƒ */
        .btn-home { background: #1a3c6e; color: #fff; }
        .btn-home:hover { background: #132b4f; }

        /* ë¡œê·¸ì•„ì›ƒ ë²„íŠ¼ ìƒ‰ìƒ */
        .btn-logout { background: #888; color: #fff; }
        .btn-logout:hover { background: #666; }

        /* ê²Œì‹œíŒ í…Œì´ë¸” */
        .board-table { width: 100%; border-collapse: collapse; font-size: 0.95rem; }
        .board-table th { background: #f8f9fa; padding: 15px; border-bottom: 2px solid #ddd; color: #555; font-weight: bold; text-align: center; }
        .board-table td { padding: 15px; border-bottom: 1px solid #eee; color: #333; text-align: center; }
        
        .board-table td.title-col { text-align: left; cursor: pointer; color: #1a3c6e; font-weight: 500; }
        .board-table td.title-col:hover { text-decoration: underline; color: #f4a261; }
        
        /* ëª¨ë°”ì¼ ëŒ€ì‘ */
        @media (max-width: 600px) {
            .board-table th:nth-child(1), .board-table td:nth-child(1), 
            .board-table th:nth-child(3), .board-table td:nth-child(3), 
            .board-table th:nth-child(4), .board-table td:nth-child(4) { display: none; }
            .board-title { font-size: 1.4rem; }
            .container { padding: 20px; }
        }

        /* íŒì—…(ëª¨ë‹¬) ìŠ¤íƒ€ì¼ */
        #post-modal { display: none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.5); }
        .modal-content { background-color: #fff; margin: 10% auto; padding: 30px; border-radius: 10px; width: 90%; max-width: 600px; position: relative; box-shadow: 0 10px 30px rgba(0,0,0,0.2); }
        .close-btn { position: absolute; top: 15px; right: 20px; font-size: 24px; cursor: pointer; color: #aaa; }
        .modal-header { border-bottom: 1px solid #eee; padding-bottom: 15px; margin-bottom: 20px; }
        .modal-title { font-size: 1.4rem; font-weight: bold; color: #1a3c6e; margin-bottom: 10px; }
        .modal-meta { font-size: 0.9rem; color: #888; }
        .modal-body { line-height: 1.8; color: #333; min-height: 150px; white-space: pre-line; }
    </style>
</head>
<body>

    <div class="container">
        <div class="board-header">
            <div class="board-title">ğŸ“¢ í•™ë¶€ëª¨ ì•Œë¦¼ì¥</div>
            
            <div class="header-btns">
                <a href="index.html" class="btn-common btn-home">ğŸ  í™ˆìœ¼ë¡œ</a>
                <button class="btn-common btn-logout" onclick="logout()">ë¡œê·¸ì•„ì›ƒ</button>
            </div>
        </div>

        <p style="margin-bottom: 20px; color: #666;">
            ì•„ì´ë“¤ì˜ í™œë™ ì†Œì‹ê³¼ ê³µì§€ì‚¬í•­ì„ í™•ì¸í•˜ì„¸ìš”. (ì œëª©ì„ í´ë¦­í•˜ë©´ ë‚´ìš©ì„ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.)
        </p>

        <table class="board-table">
            <thead>
                <tr>
                    <th width="10%">ë²ˆí˜¸</th>
                    <th width="50%">ì œëª©</th>
                    <th width="20%">ë‚ ì§œ</th>
                    <th width="20%">ì‘ì„±ì</th>
                </tr>
            </thead>
            <tbody id="board-list">
                <tr>
                    <td colspan="4" style="padding: 30px;">ê²Œì‹œê¸€ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ì…ë‹ˆë‹¤...</td>
                </tr>
            </tbody>
        </table>
    </div>

    <div id="post-modal">
        <div class="modal-content">
            <span class="close-btn" onclick="closeModal()">&times;</span>
            <div class="modal-header">
                <div class="modal-title" id="m-title">ì œëª©</div>
                <div class="modal-meta" id="m-meta">ë‚ ì§œ | ì‘ì„±ì</div>
            </div>
            <div class="modal-body" id="m-body">ë‚´ìš©</div>
        </div>
    </div>

    <script>
        // [1] ë¡œê·¸ì¸ ì²´í¬
        if (sessionStorage.getItem("isParent") !== "true") {
            alert("ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.");
            window.location.href = "login.html";
        }

        // [2] ì—‘ì…€ ê²Œì‹œíŒ ë°ì´í„° ì£¼ì†Œ (â˜…ì—¬ê¸°ì— ì£¼ì†Œë¥¼ ê¼­ ë‹¤ì‹œ ë„£ì–´ì£¼ì„¸ìš”!â˜…)
        const BOARD_SHEET_URL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vSN8NdA-JjKfu9o4yDerh-yIRyxZwqiqWNiibSCRPfmk9DYz370uAOq_H9A1oUDLDi6olVwHAi52Qth/pub?gid=0&single=true&output=csv";

        // [3] ê²Œì‹œê¸€ ë¶ˆëŸ¬ì˜¤ê¸°
        async function loadBoard() {
            try {
                const response = await fetch(BOARD_SHEET_URL);
                const data = await response.text();
                const rows = data.split("\n").slice(1); 

                const boardList = document.getElementById('board-list');
                boardList.innerHTML = ""; 

                rows.reverse().forEach((row, index) => {
                    if(row.trim() === "") return;
                    const cols = parseCSVRow(row);
                    
                    const no = cols[0];
                    const title = cols[1];
                    const date = cols[2];
                    const writer = cols[3];
                    const content = cols[4];

                    const tr = document.createElement('tr');
                    tr.innerHTML = `
                        <td>${no}</td>
                        <td class="title-col" onclick="openModal('${title}', '${writer}', '${date}', \`${content}\`)">${title}</td>
                        <td>${writer}</td>
                        <td>${date}</td>
                    `;
                    boardList.appendChild(tr);
                });

            } catch (error) {
                console.error(error);
                document.getElementById('board-list').innerHTML = `<tr><td colspan="4">ê²Œì‹œê¸€ì„ ë¶ˆëŸ¬ì˜¤ì§€ ëª»í–ˆìŠµë‹ˆë‹¤. (ì£¼ì†Œë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”)</td></tr>`;
            }
        }

        function parseCSVRow(row) {
            const result = [];
            let current = '';
            let inQuote = false;
            for (let i = 0; i < row.length; i++) {
                const char = row[i];
                if (char === '"') { inQuote = !inQuote; }
                else if (char === ',' && !inQuote) {
                    result.push(current.trim()); current = '';
                } else { current += char; }
            }
            result.push(current.trim());
            return result;
        }

        function openModal(title, writer, date, content) {
            document.getElementById('m-title').innerText = title;
            document.getElementById('m-meta').innerText = `ì‘ì„±ì¼: ${writer} | ì‘ì„±ì: ${date}`;
            const cleanContent = content.replace(/^"|"$/g, '').replace(/\\n/g, '\n');
            document.getElementById('m-body').innerText = cleanContent;
            document.getElementById('post-modal').style.display = 'block';
        }

        function closeModal() {
            document.getElementById('post-modal').style.display = 'none';
        }

        window.onclick = function(event) {
            if (event.target == document.getElementById('post-modal')) {
                closeModal();
            }
        }

        function logout() {
            sessionStorage.removeItem("isParent");
            window.location.href = "login.html"; // ë¡œê·¸ì•„ì›ƒ ì‹œ ë¡œê·¸ì¸ í™”ë©´ìœ¼ë¡œ
        }

        loadBoard();
    </script>

</body>
</html>